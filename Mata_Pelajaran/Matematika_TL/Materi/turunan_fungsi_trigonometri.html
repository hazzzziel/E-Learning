<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turunan Fungsi Trigonometri - Matematika Tingkat Lanjut</title>
    <style>
        /* ===== CSS VARIABLES ===== */
        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-card: #ffffff;
            --fg-primary: #0f172a;
            --fg-secondary: #334155;
            --fg-muted: #64748b;
            --accent-primary: #4f46e5;
            --accent-secondary: #0ea5e9;
            --accent-success: #10b981;
            --accent-danger: #ef4444;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 18px;
            --transition-fast: 0.15s ease;
        }

        /* ===== GLOBAL RESET ===== */
        *, *::before, *::after { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        html { 
            scroll-behavior: smooth; 
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--fg-primary);
            line-height: 1.6;
        }

        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.3;
            color: var(--fg-primary);
        }

        /* ===== NAVBAR ===== */
        .navbar {
            position: sticky;
            top: 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid rgba(79, 70, 229, 0.1);
            z-index: 1000;
            padding: 0 24px;
        }

        .navbar-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 64px;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--fg-primary);
        }

        .navbar-logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .navbar-title { font-weight: 700; }
        .navbar-title span { color: var(--accent-primary); }

        .btn-nav {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background-color: var(--bg-secondary);
            color: var(--fg-secondary);
            border: none;
            border-radius: var(--radius-sm);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: var(--transition-fast);
        }

        .btn-nav:hover {
            background-color: var(--accent-primary);
            color: white;
        }

        /* ===== HERO ===== */
        .hero {
            padding: 48px 24px 32px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .breadcrumb {
            display: flex;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--fg-muted);
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .breadcrumb a {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: 600;
        }
        
        .breadcrumb a:hover { text-decoration: underline; }

        .hero-title {
            font-size: clamp(2rem, 4vw, 2.8rem);
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-desc {
            font-size: 1.1rem;
            color: var(--fg-secondary);
            max-width: 600px;
            margin-top: 12px;
        }

        /* ===== TABS ===== */
        .section-nav {
            position: sticky;
            top: 64px;
            background-color: var(--bg-primary);
            z-index: 999;
            padding: 0 24px;
            border-bottom: 1px solid var(--bg-secondary);
        }

        .tabs-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 12px 0;
        }

        .tab-btn {
            padding: 10px 24px;
            border: none;
            background: transparent;
            color: var(--fg-secondary);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: var(--transition-fast);
            white-space: nowrap;
        }

        .tab-btn:hover { background-color: rgba(79, 70, 229, 0.08); }
        .tab-btn.active { background-color: var(--accent-primary); color: white; }

        /* ===== CONTENT SECTIONS ===== */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 24px 80px;
        }

        .content-section {
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .content-section.active {
            display: block;
            opacity: 1;
        }

        /* ===== MODULE GRID ===== */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 24px;
        }

        .module-card {
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(79, 70, 229, 0.05);
        }

        .module-header {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--bg-secondary);
        }

        .module-icon {
            width: 48px;
            height: 48px;
            background-color: rgba(79, 70, 229, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-primary);
            flex-shrink: 0;
        }

        .module-title { font-size: 1.2rem; margin-bottom: 4px; }
        .module-subtitle { font-size: 0.9rem; color: var(--fg-muted); }

        .module-content h3 {
            font-size: 1rem;
            color: var(--accent-primary);
            margin: 20px 0 10px;
            padding-left: 12px;
            border-left: 3px solid var(--accent-primary);
        }

        .module-content p, .module-content li {
            font-size: 0.95rem;
            color: var(--fg-secondary);
            margin-bottom: 8px;
        }

        .module-content ul {
            list-style: disc;
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .formula-box {
            background-color: rgba(79, 70, 229, 0.05);
            border: 1px solid rgba(79, 70, 229, 0.1);
            border-radius: var(--radius-md);
            padding: 16px;
            margin: 16px 0;
            text-align: center;
        }

        .formula {
            font-family: "Cambria Math", "Times New Roman", serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-primary);
        }
        
        .ref-link {
            display: inline-block;
            font-size: 0.8rem;
            color: var(--accent-secondary);
            text-decoration: none;
            margin-right: 8px;
            font-weight: 600;
        }
        .ref-link:hover { text-decoration: underline; }

        /* ===== VISUALIZATION LAYOUT ===== */
        .viz-container {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 24px;
        }

        .viz-controls {
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-soft);
            height: fit-content;
        }

        .ctrl-title {
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ctrl-group { margin-bottom: 20px; }

        .ctrl-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .ctrl-val {
            font-family: monospace;
            color: var(--accent-primary);
            background-color: rgba(79, 70, 229, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Unified Slider & Select Style */
        .ctrl-input {
            width: 100%;
            padding: 8px;
            background-color: var(--bg-secondary);
            border: 1px solid transparent;
            border-radius: var(--radius-sm);
            color: var(--fg-secondary);
            font-family: inherit;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
        }
        
        .ctrl-input:focus {
            border-color: var(--accent-primary);
        }

        /* Range Slider Specifics */
        input[type="range"].ctrl-input {
            height: 6px;
            padding: 0;
            cursor: pointer;
            -webkit-appearance: none;
        }

        input[type="range"].ctrl-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background-color: var(--accent-primary);
            border-radius: 50%;
            cursor: pointer;
            margin-top: -6px; /* Center thumb vertically */
        }
        
        /* Buttons Group */
        .btn-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-pill {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--bg-secondary);
            background-color: var(--bg-secondary);
            color: var(--fg-secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
            transition: var(--transition-fast);
        }

        .btn-pill.active {
            background-color: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }
        
        .btn-pill:hover:not(.active) {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .btn-action {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--accent-primary);
            background-color: transparent;
            color: var(--accent-primary);
            border-radius: var(--radius-sm);
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-fast);
            margin-top: 16px;
        }

        .btn-action:hover {
            background-color: var(--accent-primary);
            color: white;
        }

        /* Canvas Area */
        .viz-canvas-area {
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
        }

        .viz-header {
            padding: 16px 24px;
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(79, 70, 229, 0.05);
        }

        .viz-result {
            font-family: monospace;
            background-color: rgba(79, 70, 229, 0.1);
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            color: var(--accent-primary);
            font-size: 0.85rem;
        }

        .canvas-wrapper {
            position: relative;
            height: 450px;
            background-color: #fcfcfc;
        }

        #simCanvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .info-panel {
            padding: 16px 24px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            border-top: 1px solid rgba(79, 70, 229, 0.05);
        }

        .info-item { display: flex; flex-direction: column; gap: 4px; }
        .info-label { font-size: 0.75rem; color: var(--fg-muted); text-transform: uppercase; }
        .info-val { font-family: monospace; font-size: 1.1rem; font-weight: 700; }

        /* ===== QUIZ ===== */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-header {
            background-color: var(--bg-card);
            padding: 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .score-box {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .question-card {
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-soft);
            border: 1px solid transparent;
            transition: border-color 0.2s;
        }
        
        .question-card.correct { border-color: var(--accent-success); }
        .question-card.wrong { border-color: var(--accent-danger); }

        .q-num {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background-color: var(--accent-primary);
            color: white;
            border-radius: 50%;
            margin-right: 12px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .q-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }

        .options { display: grid; gap: 10px; }

        .opt-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            background-color: var(--bg-secondary);
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: left;
            transition: var(--transition-fast);
        }

        .opt-btn:hover { border-color: var(--accent-primary); }
        .opt-btn.selected { border-color: var(--accent-primary); background-color: rgba(79, 70, 229, 0.05); }
        .opt-btn.correct { border-color: var(--accent-success); background-color: rgba(16, 185, 129, 0.1); pointer-events: none; }
        .opt-btn.wrong { border-color: var(--accent-danger); background-color: rgba(239, 68, 68, 0.1); pointer-events: none; }
        .opt-btn.disabled { pointer-events: none; opacity: 0.7; }

        .opt-letter {
            width: 28px;
            height: 28px;
            border: 2px solid var(--fg-muted);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
            font-size: 0.9rem;
            transition: var(--transition-fast);
        }

        .opt-btn.selected .opt-letter { background-color: var(--accent-primary); border-color: var(--accent-primary); color: white; }
        .opt-btn.correct .opt-letter { background-color: var(--accent-success); border-color: var(--accent-success); color: white; }
        .opt-btn.wrong .opt-letter { background-color: var(--accent-danger); border-color: var(--accent-danger); color: white; }

        .feedback {
            margin-top: 12px;
            padding: 10px 14px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            display: none;
        }
        .feedback.show { display: block; }
        .feedback.correct { background-color: rgba(16, 185, 129, 0.1); color: #047857; }
        .feedback.wrong { background-color: rgba(239, 68, 68, 0.1); color: #b91c1c; }

        .result-card {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 40px;
            text-align: center;
            border-radius: var(--radius-lg);
            display: none;
        }
        .result-card.show { display: block; }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 900px) {
            .viz-container { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .hero { padding: 32px 16px; }
            .section-nav { top: 64px; padding: 0 16px; }
            .main-content { padding: 20px 16px 60px; }
            .canvas-wrapper { height: 350px; }
            .quiz-header { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="#" class="navbar-brand">
                <div class="navbar-logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                </div>
                <span class="navbar-title">E-Learning <span>Kelas 12</span></span>
            </a>
            <a href="FULL_DASHBOARD_URL" target="_self" class="btn-nav">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                Dashboard
            </a>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
        <div class="breadcrumb">
            <a href="FULL_DASHBOARD_URL" target="_self">Dashboard</a> / 
            <a href="FULL_MATEMATIKA_URL" target="_self">Matematika</a> / 
            <span>Turunan Fungsi Trigonometri</span>
        </div>
        <h1 class="hero-title">Turunan Fungsi Trigonometri</h1>
        <p class="hero-desc">Pelajari konsep dasar turunan trigonometri, aturan rantai, hingga aplikasinya dalam menentukan gradien garis singgung dan nilai ekstrem fungsi.</p>
    </section>

    <!-- Tabs -->
    <div class="section-nav">
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="module">Modul Materi</button>
            <button class="tab-btn" data-tab="visualization">Visualisasi Interaktif</button>
            <button class="tab-btn" data-tab="quiz">Kuis Interaktif</button>
        </div>
    </div>

    <main class="main-content">
        <!-- Section 1: Modul Materi -->
        <section class="content-section active" id="module">
            <div class="module-grid">
                <article class="module-card">
                    <div class="module-header">
                        <div class="module-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                        </div>
                        <div>
                            <h2 class="module-title">Rumus Dasar & Komposisi</h2>
                            <p class="module-subtitle">Turunan Fungsi Trigonometri</p>
                        </div>
                    </div>
                    <div class="module-content">
                        <h3>Rumus Dasar</h3>
                        <div class="formula-box">
                            <div class="formula">d/dx [sin x] = cos x</div>
                            <div class="formula">d/dx [cos x] = -sin x</div>
                        </div>
                        <h3>Fungsi Komposisi (Chain Rule)</h3>
                        <p>Untuk f(x) = sin(ax + b), turunannya:</p>
                        <div class="formula-box">
                            <div class="formula">d/dx sin(ax+b) = a cos(ax+b)</div>
                        </div>
                        <p><strong>Contoh:</strong> f(x) = sin(2x), maka f'(x) = 2cos(2x).</p>
                        <h3>Referensi</h3>
                        <a href="#" class="ref-link">Mamikos</a>
                    </div>
                </article>

                <article class="module-card">
                    <div class="module-header">
                        <div class="module-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
                        </div>
                        <div>
                            <h2 class="module-title">Konsep Dasar</h2>
                            <p class="module-subtitle">Definisi Turunan</p>
                        </div>
                    </div>
                    <div class="module-content">
                        <h3>Definisi Turunan</h3>
                        <p>Turunan fungsi f(x) didefinisikan sebagai batas:</p>
                        <div class="formula-box">
                            <div class="formula">f'(x) = lim (h→0) [f(x+h) - f(x)] / h</div>
                        </div>
                        <p>Geometris: gradien garis singgung kurva di titik x.</p>
                        <h3>Turunan Konstanta</h3>
                        <p>[k ⋅ u(x)]' = k ⋅ u'(x). Contoh: (3 sin x)' = 3 cos x.</p>
                    </div>
                </article>

                <article class="module-card">
                    <div class="module-header">
                        <div class="module-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                        </div>
                        <div>
                            <h2 class="module-title">Aplikasi Turunan</h2>
                            <p class="module-subtitle">Garis Singgung & Ekstrem</p>
                        </div>
                    </div>
                    <div class="module-content">
                        <h3>Garis Singgung</h3>
                        <p>Persamaan di titik (x₀, y₀):</p>
                        <div class="formula-box">
                            <div class="formula">y - y₀ = m (x - x₀)</div>
                            <p style="font-size:0.8rem; color:var(--fg-muted); margin-top:6px;">dengan m = f'(x₀)</p>
                        </div>
                        <h3>Titik Ekstrem</h3>
                        <p>Stasioner jika f'(x) = 0.</p>
                        <table class="info-table" style="width:100%; border-collapse:collapse; margin-top:10px; font-size:0.9rem;">
                            <tr style="background:var(--bg-secondary)"><th style="padding:8px; text-align:left">Kondisi</th><th style="padding:8px; text-align:left">Jenis</th></tr>
                            <tr><td style="padding:8px; border-bottom:1px solid var(--bg-secondary)">f''(x) < 0</td><td style="padding:8px; border-bottom:1px solid var(--bg-secondary)">Maksimum Lokal</td></tr>
                            <tr><td style="padding:8px">f''(x) > 0</td><td style="padding:8px">Minimum Lokal</td></tr>
                        </table>
                    </div>
                </article>
            </div>
        </section>

        <!-- Section 2: Visualisasi -->
        <section class="content-section" id="visualization">
            <div class="viz-container">
                <aside class="viz-controls">
                    <h3 class="ctrl-title">Kontrol Simulasi</h3>

                    <div class="ctrl-group">
                        <label class="ctrl-label">Mode Visualisasi</label>
                        <select id="modeSelect" class="ctrl-input">
                            <option value="definition">1. Konsep Turunan (h -> 0)</option>
                            <option value="basic">2. Rumus Dasar (Dual Graph)</option>
                            <option value="tangent">3. Garis Singgung</option>
                        </select>
                    </div>

                    <div id="ctrlDefinition">
                        <div class="ctrl-group">
                            <label class="ctrl-label">Nilai h <span class="ctrl-val" id="valH">1.00</span></label>
                            <input type="range" class="ctrl-input" id="sliderH" min="0.01" max="2" step="0.01" value="1">
                        </div>
                        <div class="ctrl-group">
                            <label class="ctrl-label">Titik x₀ <span class="ctrl-val" id="valX0">1.00</span></label>
                            <input type="range" class="ctrl-input" id="sliderX0" min="-3" max="3" step="0.1" value="1">
                        </div>
                    </div>

                    <div id="ctrlBasic" style="display:none;">
                        <div class="ctrl-group">
                            <label class="ctrl-label">Tampilkan</label>
                            <div class="btn-group">
                                <button class="btn-pill active" id="btnShowF">f(x)</button>
                                <button class="btn-pill active" id="btnShowFp">f'(x)</button>
                            </div>
                        </div>
                    </div>

                    <div id="ctrlTangent" style="display:none;">
                        <div class="ctrl-group">
                            <label class="ctrl-label">Titik x₀ <span class="ctrl-val" id="valTanX">1.00</span></label>
                            <input type="range" class="ctrl-input" id="sliderTanX" min="-3" max="3" step="0.1" value="1">
                        </div>
                    </div>

                    <button class="btn-action" id="btnReset">Reset Simulasi</button>
                </aside>

                <div class="viz-canvas-area">
                    <div class="viz-header">
                        <h3 class="viz-title" id="vizTitle">Definisi Turunan (Limit)</h3>
                        <span class="viz-result" id="vizResult">f'(x) ≈ ...</span>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="simCanvas"></canvas>
                    </div>
                    <div class="info-panel">
                        <div class="info-item">
                            <span class="info-label">Nilai f(x₀)</span>
                            <span class="info-val" id="infoFx">0.00</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Gradien (m)</span>
                            <span class="info-val" id="infoM">0.00</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Hasil Analitis</span>
                            <span class="info-val" id="infoAnalytic">0.00</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Quiz -->
        <section class="content-section" id="quiz">
            <div class="quiz-container">
                <div class="quiz-header">
                    <div>
                        <h2>Kuis Turunan Trigonometri</h2>
                        <p>Uji pemahaman Anda dengan 5 soal acak</p>
                    </div>
                    <div class="score-box">
                        Skor: <span id="scoreVal">0</span>/5
                    </div>
                </div>

                <div style="display:flex; gap:12px; margin-bottom:24px;">
                    <button id="btnGen" class="btn-action" style="background-color:var(--accent-primary); color:white;">Generate Soal Baru</button>
                    <button id="btnRetry" class="btn-action">Ulangi Kuis</button>
                </div>

                <div id="qContainer"></div>

                <div class="result-card" id="resultCard">
                    <h3 style="font-size:1.5rem;">Kuis Selesai!</h3>
                    <div style="font-size:3rem; font-weight:800; margin:16px 0;" id="finalScore">0/5</div>
                    <p style="font-size:1rem; opacity:0.9;" id="finalMsg">Terus berlatih!</p>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ========== QUESTION BANK ==========
        const qBank = [
            { q: "Turunan dari f(x) = sin x adalah...", opts: ["cos x", "-sin x", "sec² x", "-cos x"], ans: 0, exp: "Rumus dasar: d/dx (sin x) = cos x." },
            { q: "Turunan dari f(x) = cos x adalah...", opts: ["sin x", "-sin x", "cos x", "-cos x"], ans: 1, exp: "Rumus dasar: d/dx (cos x) = -sin x." },
            { q: "Turunan dari f(x) = tan x adalah...", opts: ["cot x", "-sec² x", "sec² x", "-cot x"], ans: 2, exp: "Rumus dasar: d/dx (tan x) = sec² x." },
            { q: "Turunan dari f(x) = sin(2x) adalah...", opts: ["2 sin(2x)", "2 cos(2x)", "cos(2x)", "-2 sin(2x)"], ans: 1, exp: "Chain rule: d/dx sin(u) = cos(u) * u'. u=2x, u'=2. Hasil = 2 cos(2x)." },
            { q: "Turunan dari f(x) = 5 sin x adalah...", opts: ["5 cos x", "-5 sin x", "5 tan x", "-5 cos x"], ans: 0, exp: "Konstanta dapat dikeluarkan: 5 * (sin x)' = 5 cos x." },
            { q: "Turunan dari f(x) = x sin x adalah...", opts: ["sin x + x cos x", "sin x - x cos x", "x cos x", "cos x"], ans: 0, exp: "Product rule: (uv)' = u'v + uv'. (1)(sin x) + (x)(cos x)." },
            { q: "Turunan dari f(x) = cos(3x) adalah...", opts: ["3 sin(3x)", "-3 sin(3x)", "3 cos(3x)", "-3 cos(3x)"], ans: 1, exp: "Chain rule: -sin(3x) * 3 = -3 sin(3x)." },
            { q: "Gradien garis singgung y = sin x di x = π/2 adalah...", opts: ["1", "0", "-1", "1/2"], ans: 1, exp: "y' = cos x. cos(π/2) = 0." },
            { q: "Jika f'(x) > 0 pada interval, maka fungsi...", opts: ["Turun", "Naik", "Stasioner", "Maksimum"], ans: 1, exp: "Turunan positif menunjukkan fungsi naik." },
            { q: "Turunan dari f(x) = sin x + cos x adalah...", opts: ["sin x - cos x", "cos x - sin x", "cos x + sin x", "-sin x - cos x"], ans: 1, exp: "(sin x)' + (cos x)' = cos x - sin x." }
        ];

        // ========== GLOBAL STATE ==========
        let currentQ = [];
        let userAns = [];
        let qSubmitted = false;
        let score = 0;

        let vizState = { mode: 'definition', h: 1.0, x0: 1.0, showF: true, showFp: true, tanX: 1.0 };
        let canvas, ctx, W, H;

        // ========== INIT ==========
        document.addEventListener('DOMContentLoaded', () => {
            initTabs();
            initViz();
            initQuiz();
        });

        function initTabs() {
            const tabs = document.querySelectorAll('.tab-btn');
            const sections = document.querySelectorAll('.content-section');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Update buttons
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Update sections
                    const target = tab.dataset.tab;
                    sections.forEach(s => {
                        s.classList.remove('active');
                        if(s.id === target) s.classList.add('active');
                    });
                    
                    if(target === 'visualization') {
                        setTimeout(() => { resizeCanvas(); draw(); }, 50);
                    }
                });
            });
        }

        // ========== VISUALIZATION ==========
        function initViz() {
            canvas = document.getElementById('simCanvas');
            if(!canvas) return;
            ctx = canvas.getContext('2d');
            
            resizeCanvas();
            
            document.getElementById('modeSelect').addEventListener('change', (e) => {
                vizState.mode = e.target.value;
                updateCtrlVisibility();
                draw();
            });

            bindSlider('sliderH', 'valH', v => { vizState.h = v; draw(); });
            bindSlider('sliderX0', 'valX0', v => { vizState.x0 = v; draw(); });
            bindSlider('sliderTanX', 'valTanX', v => { vizState.tanX = v; draw(); });

            document.getElementById('btnShowF').addEventListener('click', function() { 
                this.classList.toggle('active'); 
                vizState.showF = this.classList.contains('active'); 
                draw(); 
            });
            document.getElementById('btnShowFp').addEventListener('click', function() { 
                this.classList.toggle('active'); 
                vizState.showFp = this.classList.contains('active'); 
                draw(); 
            });
            
            document.getElementById('btnReset').addEventListener('click', resetViz);
            
            window.addEventListener('resize', () => { resizeCanvas(); draw(); });
            
            updateCtrlVisibility();
            draw();
        }

        function resizeCanvas() {
            if(!canvas) return;
            const parent = canvas.parentElement;
            canvas.width = parent.offsetWidth;
            canvas.height = parent.offsetHeight;
            W = canvas.width;
            H = canvas.height;
        }

        function bindSlider(sId, vId, cb) {
            const s = document.getElementById(sId);
            const v = document.getElementById(vId);
            if(s && v) {
                s.addEventListener('input', (e) => {
                    const val = parseFloat(e.target.value);
                    v.textContent = val.toFixed(2);
                    cb(val);
                });
            }
        }
        
        function updateCtrlVisibility() {
            const ctrlDefs = document.getElementById('ctrlDefinition');
            const ctrlBas = document.getElementById('ctrlBasic');
            const ctrlTan = document.getElementById('ctrlTangent');
            
            if(ctrlDefs) ctrlDefs.style.display = 'none';
            if(ctrlBas) ctrlBas.style.display = 'none';
            if(ctrlTan) ctrlTan.style.display = 'none';
            
            if(vizState.mode === 'definition' && ctrlDefs) ctrlDefs.style.display = 'block';
            if(vizState.mode === 'basic' && ctrlBas) ctrlBas.style.display = 'block';
            if(vizState.mode === 'tangent' && ctrlTan) ctrlTan.style.display = 'block';
            
            const titles = { definition: 'Definisi Turunan (Limit)', basic: 'Grafik f(x) dan f\'(x)', tangent: 'Garis Singgung' };
            document.getElementById('vizTitle').textContent = titles[vizState.mode];
        }

        function resetViz() {
            vizState = { mode: vizState.mode, h: 1.0, x0: 1.0, showF: true, showFp: true, tanX: 1.0 };
            draw();
        }

        function draw() {
            if(!ctx) return;
            ctx.clearRect(0, 0, W, H);
            ctx.fillStyle = '#fcfcfc';
            ctx.fillRect(0, 0, W, H);
            
            drawGrid();
            
            if(vizState.mode === 'definition') drawDefinition();
            else if(vizState.mode === 'basic') drawBasic();
            else if(vizState.mode === 'tangent') drawTangent();
        }

        function drawGrid() {
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 1;
            const step = 40;
            for(let x=0; x<W; x+=step) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, H); ctx.stroke(); }
            for(let y=0; y<H; y+=step) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(W, y); ctx.stroke(); }
        }

        function tx(x) { return W/2 + x * 40; }
        function ty(y) { return H/2 - y * 40; }

        function drawDefinition() {
            const x0 = vizState.x0;
            const h = vizState.h;
            
            // Draw Function Sin(x)
            ctx.beginPath();
            ctx.strokeStyle = '#4f46e5';
            ctx.lineWidth = 2;
            for(let px = 0; px < W; px++) {
                const x = (px - W/2)/40;
                const y = Math.sin(x);
                if(px === 0) ctx.moveTo(tx(x), ty(y));
                else ctx.lineTo(tx(x), ty(y));
            }
            ctx.stroke();

            const f0 = Math.sin(x0);
            const f1 = Math.sin(x0 + h);
            const slope = (f1 - f0) / h;
            
            // Secant Line
            ctx.beginPath();
            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 1.5;
            ctx.setLineDash([5, 5]);
            ctx.moveTo(tx(x0 - 2), ty(f0 + slope * -2));
            ctx.lineTo(tx(x0 + h + 2), ty(f1 + slope * 2));
            ctx.stroke();
            ctx.setLineDash([]);

            // Tangent Line (Theoretical)
            const analyticSlope = Math.cos(x0);
            ctx.beginPath();
            ctx.strokeStyle = '#10b981';
            ctx.lineWidth = 2;
            ctx.setLineDash([2, 2]);
            ctx.moveTo(tx(x0 - 2), ty(f0 + analyticSlope * -2));
            ctx.lineTo(tx(x0 + 2), ty(f0 + analyticSlope * 2));
            ctx.stroke();
            ctx.setLineDash([]);

            // Points
            drawPoint(tx(x0), ty(f0), '#0ea5e9', "A");
            drawPoint(tx(x0+h), ty(f1), '#f97316', "B");

            document.getElementById('vizResult').textContent = `m ≈ (sin(${(x0+h).toFixed(2)}) - sin(${x0.toFixed(2)})) / ${h.toFixed(2)}`;
            document.getElementById('infoFx').textContent = f0.toFixed(3);
            document.getElementById('infoM').textContent = slope.toFixed(3);
            document.getElementById('infoAnalytic').textContent = analyticSlope.toFixed(3);
        }

        function drawBasic() {
            if(vizState.showF) {
                ctx.beginPath(); ctx.strokeStyle = '#4f46e5'; ctx.lineWidth = 2;
                for(let px=0; px<W; px++) { const x = (px - W/2)/40; if(px===0) ctx.moveTo(tx(x), ty(Math.sin(x))); else ctx.lineTo(tx(x), ty(Math.sin(x))); }
                ctx.stroke();
            }
            if(vizState.showFp) {
                ctx.beginPath(); ctx.strokeStyle = '#ef4444'; ctx.lineWidth = 2;
                for(let px=0; px<W; px++) { const x = (px - W/2)/40; if(px===0) ctx.moveTo(tx(x), ty(Math.cos(x))); else ctx.lineTo(tx(x), ty(Math.cos(x))); }
                ctx.stroke();
            }
            
            document.getElementById('vizResult').textContent = "Hubungan: Puncak Sin(x) terjadi saat Cos(x) = 0";
        }

        function drawTangent() {
            const x0 = vizState.tanX;
            const f = x => Math.sin(x);
            const m = Math.cos(x0);
            const y0 = f(x0);

            ctx.beginPath(); ctx.strokeStyle = '#4f46e5'; ctx.lineWidth = 2;
            for(let px=0; px<W; px++) { const x = (px - W/2)/40; if(px===0) ctx.moveTo(tx(x), ty(f(x))); else ctx.lineTo(tx(x), ty(f(x))); }
            ctx.stroke();

            ctx.beginPath(); ctx.strokeStyle = '#ef4444'; ctx.lineWidth = 2;
            ctx.moveTo(tx(x0 - 3), ty(y0 + m * -3));
            ctx.lineTo(tx(x0 + 3), ty(y0 + m * 3));
            ctx.stroke();

            drawPoint(tx(x0), ty(y0), '#10b981', "P");
            
            document.getElementById('vizResult').textContent = `y - ${y0.toFixed(2)} = ${m.toFixed(2)}(x - ${x0.toFixed(2)})`;
            document.getElementById('infoFx').textContent = y0.toFixed(2);
            document.getElementById('infoM').textContent = m.toFixed(2);
        }

        function drawPoint(x, y, color, label) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#0f172a';
            ctx.font = '12px sans-serif';
            ctx.fillText(label, x + 8, y - 8);
        }

        // ========== QUIZ ==========
        function initQuiz() {
            document.getElementById('btnGen').addEventListener('click', generateQuiz);
            document.getElementById('btnRetry').addEventListener('click', generateQuiz);
            generateQuiz();
        }

        function generateQuiz() {
            qSubmitted = false;
            score = 0;
            document.getElementById('scoreVal').textContent = '0';
            document.getElementById('resultCard').classList.remove('show');
            
            currentQ = qBank.sort(() => Math.random() - 0.5).slice(0, 5);
            userAns = new Array(5).fill(null);
            renderQ();
        }

        function renderQ() {
            const c = document.getElementById('qContainer');
            c.innerHTML = '';
            currentQ.forEach((q, i) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = 'q' + i;
                
                let html = `<p class="q-text"><span class="q-num">${i+1}</span>${q.q}</p><div class="options">`;
                q.opts.forEach((opt, j) => {
                    html += `<button class="opt-btn" onclick="selectOpt(${i}, ${j}, this)">
                        <span class="opt-letter">${String.fromCharCode(65+j)}</span>
                        <span>${opt}</span>
                    </button>`;
                });
                html += `</div><div class="feedback" id="fb${i}"></div>`;
                
                card.innerHTML = html;
                c.appendChild(card);
            });
        }

        function selectOpt(qIdx, oIdx, btn) {
            if(qSubmitted) return;
            
            const parent = btn.parentElement;
            parent.querySelectorAll('.opt-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            
            userAns[qIdx] = oIdx;
            
            if(userAns.indexOf(null) === -1) submitQ();
        }

        function submitQ() {
            qSubmitted = true;
            score = 0;
            currentQ.forEach((q, i) => {
                const card = document.getElementById('q' + i);
                const opts = card.querySelectorAll('.opt-btn');
                const fb = document.getElementById('fb' + i);
                
                opts.forEach((btn, j) => {
                    btn.classList.add('disabled');
                    if(j === q.ans) btn.classList.add('correct');
                    if(userAns[i] === j && j !== q.ans) btn.classList.add('wrong');
                });
                
                if(userAns[i] === q.ans) {
                    score++;
                    fb.className = 'feedback show correct';
                    fb.textContent = 'Benar! ' + q.exp;
                } else {
                    fb.className = 'feedback show wrong';
                    fb.textContent = 'Salah. ' + q.exp;
                }
            });
            
            document.getElementById('scoreVal').textContent = score;
            document.getElementById('finalScore').textContent = score + '/5';
            let msg = "Terus berlatih!";
            if(score === 5) msg = "Sempurna!";
            else if(score >= 3) msg = "Bagus sekali!";
            document.getElementById('finalMsg').textContent = msg;
            document.getElementById('resultCard').classList.add('show');
        }
    </script>
</body>
</html>
